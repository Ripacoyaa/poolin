<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Settings - Poolin</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body class="flex h-screen overflow-hidden bg-[#CFF1F9]">

  <!-- SIDEBAR -->
  <aside class="w-64 bg-gradient-to-b from-[#050691] to-[#0608C4] text-white p-6 flex flex-col">
    <div class="text-3xl font-bold mb-0 flex items-center gap-2">
      <img src="D:/Poolin/assets/logoPoolin.png" class="w-30 opacity-90" />
    </div>

    <nav class="space-y-2">
      <a href="dashboardGroup.html" class="flex items-center gap-3 px-4 py-3 rounded-xl font-bold hover:bg-[#023E8A] transition">
        <img src="D:/Poolin/assets/homePage.png" class="w-8 opacity-90" /> Home
      </a>
      <a href="myRoomsGroup.html" class="flex items-center gap-3 px-4 py-3 rounded-xl font-bold hover:bg-[#023E8A] transition">
        <img src="D:/Poolin/assets/meeting.png" class="w-8 opacity-90" /> My Rooms
      </a>
      <a href="contributionGroup.html" class="flex items-center gap-3 px-4 py-3 rounded-xl font-bold hover:bg-[#023E8A] transition">
        <img src="D:/Poolin/assets/donation.png" class="w-8 opacity-90" /> Contribution
      </a>
      <div class="flex items-center gap-3 bg-[#023E8A] px-4 py-3 rounded-xl font-bold shadow-lg">
        <img src="D:/Poolin/assets/accountSetting.png" class="w-8 opacity-90" /> Account Setting
      </div>
    </nav>
  </aside>

   
  <!-- MAIN CONTENT -->
  <main class="flex-1 p-5 overflow-y-auto">

    <div class="max-w-full mx-auto flex flex-col gap-6">

      <!-- LOGOUT POPUP -->
      <div id="logoutPopup"
        class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">

        <div class="bg-white w-80 rounded-xl shadow-lg p-6 text-center">
          <h2 class="text-xl font-bold mb-3">Logout?</h2>
          <p class="text-gray-600 mb-5">Are you sure you want to logout?</p>

          <div class="flex justify-between gap-3">
            <button id="cancelLogout"
              class="flex-1 bg-gray-300 text-black py-2 rounded-xl hover:bg-gray-400 transition">
              Cancel
            </button>

            <button id="confirmLogout"
              class="flex-1 bg-red-600 text-white py-2 rounded-xl hover:bg-red-700 transition">
              Yes, Logout
            </button>
          </div>
        </div>
      </div>

      <!-- TOP BAR WITH LOGOUT -->
      <div class="flex justify-end w-full">
        <button id="logoutBtn"
          class="flex items-center gap-2 px-4 py-2 bg-red-500 text-white rounded-xl hover:bg-red-600 transition">
          <i class="fa-solid fa-right-from-bracket"></i> Logout
        </button>
      </div>


      <!-- PROFILE CARD -->
      <div class="bg-white shadow-lg rounded-2xl border border-blue-100 p-6 w-full">

        <div class="flex justify-between items-center w-full">
          <div class="flex items-center gap-4">
            <img src="D:/Poolin/assets/user.png"
                 class="w-20 h-20 rounded-full object-cover shadow-md main-profile">
            <div>
              <h2 id="profileName" class="text-2xl font-bold text-[#03045E]">
                maria123
              </h2>
            </div>
          </div>

          <button id="openModal"
            class="px-6 py-2 bg-[#1A1A7E] text-white font-semibold rounded-xl hover:bg-[#0F0F6A] shadow">
            Change Photo Profile
          </button>
        </div>

      </div>

      <!-- FORM CARD -->
      <div class="bg-white shadow-lg rounded-2xl border border-blue-100 p-6 w-full">

        <h3 class="text-lg font-bold text-[#03045E] mb-4">
          Change account information here
        </h3>

        <!-- FORM -->
<form id="settingForm" class="space-y-4">

  <!-- USERNAME -->
  <div>
    <label class="font-semibold text-gray-700">Username</label>
    <input 
      type="text"
      value="maria123"
      class="w-full border rounded-xl p-3 mt-1 bg-gray-200 text-gray-600 cursor-default"
      readonly>
  </div>

  <!-- EMAIL -->
  <div>
    <label class="font-semibold text-gray-700">Email Address</label>
    <input 
      type="email"
      value="maria@mail.com"
      class="w-full border rounded-xl p-3 mt-1 bg-gray-200 text-gray-600 cursor-default"
      readonly>
  </div>

</form>

<!-- SUBMIT BUTTON -->
<a href="editSettingGroup.html">
  <button 
    id="updateBtn"
    class="w-full mt-6 py-3 bg-[#03045E] text-white font-bold rounded-xl hover:bg-[#07089C] shadow">
    Update Information
  </button>
</a>

      </div>

    </div>

  </main>

  <!-- POPUP MODAL PHOTO -->
  <div id="photoModal" class="hidden fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50">
    <div class="bg-white w-96 p-6 rounded-2xl shadow-xl relative">

      <button id="closeModal" class="absolute top-3 right-3 text-gray-500 hover:text-gray-700 text-xl">
        &times;
      </button>

      <h2 class="text-xl font-bold text-[#03045E] mb-4 text-center">Change Profile Photo</h2>

      <div class="flex justify-center mb-4">
        <img 
          id="profilePreview"
          src="D:/Poolin/assets/user.png" 
          class="w-32 h-32 rounded-full object-cover shadow-md border">
      </div>

      <label class="block w-full bg-[#03045E] text-white py-2 rounded-xl text-center cursor-pointer hover:bg-[#0507A0] mb-3">
        Upload New Photo
        <input type="file" id="uploadPhoto" accept="image/*" class="hidden">
      </label>

      <button id="deletePhoto" class="w-full py-2 bg-red-500 text-white rounded-xl hover:bg-red-600">
        Delete Photo
      </button>

      <div class="flex justify-center mt-4">
          <button id="saveBtn" class="bg-blue-600 text-white px-4 py-2 rounded-xl">Save</button>
      </div>

    </div>
  </div>

  <!-- SUCCESS POPUP -->
  <div id="successAlert"
    class="hidden fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50">
      <div class="bg-white px-6 py-4 rounded-xl shadow-lg flex items-center gap-3 border border-green-500">
        <i class="fa-solid fa-circle-check text-green-600 text-3xl"></i>
        <span class="text-lg font-semibold text-green-700">Update Information Success!</span>
      </div>
  </div>

<script>

// MODAL PHOTO
const openModal = document.getElementById("openModal");
const closeModal = document.getElementById("closeModal");
const modal = document.getElementById("photoModal");
const uploadInput = document.getElementById("uploadPhoto");
const preview = document.getElementById("profilePreview");
const deleteBtn = document.getElementById("deletePhoto");
const saveBtn = document.getElementById("saveBtn");
const mainProfileImg = document.querySelector(".main-profile");

openModal.onclick = () => modal.classList.remove("hidden");
closeModal.onclick = () => modal.classList.add("hidden");

modal.onclick = (e) => { if (e.target === modal) modal.classList.add("hidden"); };

uploadInput.onchange = (event) => {
  const file = event.target.files[0];
  if (file) preview.src = URL.createObjectURL(file);
};

deleteBtn.onclick = () => {
  preview.src = "D:/Poolin/assets/user.png";
};

saveBtn.onclick = () => {
  // Simpan foto ke localStorage sebagai Base64
  fetch(preview.src)
    .then(res => res.blob())
    .then(blob => {
      const reader = new FileReader();
      reader.onloadend = () => {
        localStorage.setItem("profilePhoto", reader.result); // SIMPAN BASE64
        mainProfileImg.src = reader.result; // UPDATE FOTO DI HALAMAN SAAT INI
        modal.classList.add("hidden");
      };
      reader.readAsDataURL(blob);
    });
};
</script>

  <script>
// LOAD DATA DARI LOCAL STORAGE JIKA ADA
window.addEventListener("load", () => {

  // LOAD NAME, USERNAME, EMAIL
  const fullName = localStorage.getItem("fullName");
  const username = localStorage.getItem("username");
  const email = localStorage.getItem("email");

  // TAMPILKAN USERNAME DI PROFIL
  if (username) {
    document.getElementById("profileName").innerText = username;
    document.querySelectorAll('#settingForm input')[0].value = username;
  }

  if (username) {
    document.querySelectorAll('#settingForm input')[0].value = username;
  }

  if (email) {        
    document.querySelectorAll('#settingForm input')[1].value = email;
  }

  // LOAD PROFILE PHOTO (FIXED)
  const savedPhoto = localStorage.getItem("profilePhoto");
  if (savedPhoto) {
    const mainPhoto = document.querySelector(".main-profile");
    if (mainPhoto) mainPhoto.src = savedPhoto;

    const preview = document.getElementById("profilePreview");
    if (preview) preview.src = savedPhoto;
  }

});
</script>v

</body>
</html>